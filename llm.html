<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generador de PROMPT Estructurado (Modern LLM)</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-color: #f3f4f6;
      --card-bg: #ffffff;
      --text-main: #111827;
      --text-sub: #4b5563;
      --accent: #2563eb;
      --border: #d1d5db;
    }
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 2rem;
      background: var(--bg-color);
      color: var(--text-main);
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    h1 {
      font-size: 1.8rem;
      font-weight: 600;
      color: var(--text-main);
      margin-bottom: 2rem;
      border-bottom: 2px solid var(--accent);
      padding-bottom: 0.5rem;
    }
    .section {
      background: var(--card-bg);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-radius: 8px;
      border: 1px solid var(--border);
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    label {
      font-weight: 600;
      display: block;
      margin-bottom: 0.5rem;
      color: var(--text-main);
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    textarea {
      width: 100%;
      min-height: 80px;
      padding: 0.75rem;
      font-family: 'Inter', sans-serif;
      font-size: 0.95rem;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: #f9fafb;
      box-sizing: border-box;
      transition: border-color 0.2s;
    }
    textarea:focus {
      outline: none;
      border-color: var(--accent);
      background: #fff;
    }
    select {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.5rem;
      font-size: 0.9rem;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: #fff;
      cursor: pointer;
    }
    .btn-group {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    button {
      padding: 0.6rem 1.2rem;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      background-color: var(--accent);
      color: white;
      border: none;
      border-radius: 6px;
      transition: background-color 0.2s;
    }
    button:hover {
      background-color: #1d4ed8;
    }
    button.secondary {
      background-color: var(--text-sub);
    }
    pre {
      background: #1e293b;
      color: #e2e8f0;
      padding: 1.5rem;
      white-space: pre-wrap;
      word-break: break-word;
      border-radius: 8px;
      font-family: 'Menlo', 'Monaco', monospace;
      font-size: 0.85rem;
      margin-top: 2rem;
    }
  </style>
</head>
<body>

  <h1>Generador de Prompt Estructurado (Chain-of-Thought Ready)</h1>
  
  <div class="btn-group">
    <button class="secondary" onclick="ponerEjemplo()">Cargar Ejemplo: Ética Ingeniería</button>
    <button onclick="generarPrompt()">Generar XML y Copiar</button>
  </div>

  <div class="section">
    <label for="rol">Role (Persona)</label>
    <textarea id="rol" placeholder="Ej: Eres un Arquitecto de Software Senior especializado en sistemas distribuidos..."></textarea>
  </div>

  <div class="section">
    <label for="contexto">Context (Contexto y Antecedentes)</label>
    <textarea id="contexto" placeholder="Define el escenario, inputs disponibles o situación actual..."></textarea>
  </div>

  <div class="section">
    <label for="tarea">Task (Instrucción Principal)</label>
    <textarea id="tarea" placeholder="¿Cuál es el objetivo final de la interacción?"></textarea>
  </div>

  <div class="section">
    <label for="pasos">Methodology (Chain of Thought / Pasos)</label>
    <textarea id="pasos" placeholder="Instrucciones paso a paso para el razonamiento..."></textarea>
    <select onchange="insertarEnTextarea('pasos', this)">
      <option selected disabled>-- Estrategias de Razonamiento --</option>
      <option>Razona paso a paso antes de emitir la conclusión final (Chain of Thought).</option>
      <option>Desglosa el problema en sub-tareas más pequeñas y resuélvelas secuencialmente.</option>
      <option>Realiza una búsqueda online para verificar hechos antes de responder (Grounding).</option>
      <option>Analiza contra-argumentos potenciales antes de definir tu postura.</option>
      <option>Identifica las variables clave y cómo interactúan entre ellas.</option>
      <option>Actúa como revisor crítico de tu propia respuesta inicial.</option>
    </select>
  </div>

  <div class="section">
    <label for="restricciones">Constraints (Reglas Negativas y Guías)</label>
    <textarea id="restricciones" placeholder="Lo que NO debe hacer o límites estrictos..."></textarea>
    <select onchange="insertarEnTextarea('restricciones', this)">
      <option selected disabled>-- Añadir Restricción --</option>
      <option>No inventes información (alucinaciones); si no lo sabes, indícalo.</option>
      <option>Limita la respuesta estrictamente a la información provista en el contexto.</option>
      <option>Mantén un tono académico, objetivo y sin juicios de valor.</option>
      <option>No uses listas (bullet points); utiliza párrafos cohesivos.</option>
      <option>Evita el lenguaje corporativo vago o "fluff".</option>
      <option>Cita siempre las fuentes consultadas entre corchetes.</option>
      <option>Prioriza la seguridad y privacidad de datos sobre la eficiencia.</option>
    </select>
  </div>

  <div class="section">
    <label for="formato">Output Format (Formato de Salida)</label>
    <textarea id="formato" placeholder="Estructura esperada de la respuesta..."></textarea>
    <select onchange="insertarEnTextarea('formato', this)">
      <option selected disabled>-- Seleccionar Formato --</option>
      <option>Salida en formato Markdown bien estructurado.</option>
      <option>Objeto JSON válido sin texto adicional.</option>
      <option>Tabla comparativa con columnas específicas.</option>
      <option>Formato de informe técnico: Resumen Ejecutivo, Análisis, Recomendación.</option>
      <option>Código comentado siguiendo estándares de Clean Code.</option>
      <option>Bloques de código separados por lenguaje.</option>
    </select>
  </div>

  <pre id="resultado">El prompt generado aparecerá aquí...</pre>

  <script>
    function escapeXML(str) {
      if (!str) return "";
      return str.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
    }

    // Transforma listas con guiones en items XML, o deja texto plano si no hay lista
    function procesarInput(texto) {
      if (!texto) return "";
      const lineas = texto.trim().split('\n');
      // Si detectamos formato lista
      const esLista = lineas.some(l => l.trim().startsWith('-'));
      
      if (esLista) {
        return lineas.map(linea => {
          const contenido = linea.trim();
          if (contenido.startsWith('-')) {
            return `    <item>${escapeXML(contenido.substring(1).trim())}</item>`;
          } else if (contenido.length > 0) {
            return `    ${escapeXML(contenido)}`;
          }
          return "";
        }).join('\n');
      } else {
        return `    ${escapeXML(texto.trim())}`;
      }
    }

    function generarPrompt() {
      const rol = procesarInput(document.getElementById("rol").value);
      const contexto = procesarInput(document.getElementById("contexto").value);
      const tarea = procesarInput(document.getElementById("tarea").value);
      const pasos = procesarInput(document.getElementById("pasos").value);
      const restricciones = procesarInput(document.getElementById("restricciones").value);
      const formato = procesarInput(document.getElementById("formato").value);

      // Estructura optimizada para Modelos con ventanas de contexto largas
      const xml =
`<prompt_configuration>
  <role>
${rol}
  </role>
  
  <context>
${contexto}
  </context>
  
  <task>
${tarea}
  </task>
  
  <methodology>
${pasos}
  </methodology>
  
  <constraints>
${restricciones}
  </constraints>
  
  <output_format>
${formato}
  </output_format>
</prompt_configuration>`;

      document.getElementById("resultado").textContent = xml;
      navigator.clipboard.writeText(xml);
    }

    function ponerEjemplo() {
      document.getElementById("rol").value = 
`- Eres un Consultor Senior en Ética Tecnológica y Auditoría de Algoritmos.\n- Tu especialidad es la alineación de desarrollos software con marcos legales y deontológicos profesionales.`;

      document.getElementById("contexto").value = 
`- Una startup está desarrollando un módulo de "Optimización de Recursos Humanos" que analiza, sin consentimiento explícito, la actividad en redes sociales (públicas) de los empleados para predecir riesgo de burnout o baja laboral.\n- El equipo de ingeniería argumenta que al ser datos públicos, no hay infracción.`;

      document.getElementById("tarea").value = 
`- Analizar la viabilidad ética del proyecto basándose estrictamente en el código deontológico oficial de la ingeniería informática en España.\n- Emitir un veredicto formal sobre si el desarrollo debe continuar, modificarse o cancelarse.`;

      document.getElementById("pasos").value = 
`- Realizar una búsqueda en línea para localizar y leer el "Código Deontológico de la Ingeniería Informática" (CCII o colegios autonómicos relevantes).\n- Identificar los artículos específicos que entran en conflicto con el uso de datos sin consentimiento y la finalidad del algoritmo.\n- Contrastar el argumento de "datos públicos" con los principios de privacidad y deber de secreto del ingeniero.\n- Sintetizar la conclusión en un argumento lógico-deductivo.`;

      document.getElementById("restricciones").value = 
`- Citar textualmente los artículos del código deontológico vulnerados.\n- Mantener un tono formal, objetivo y autoritario (en el sentido de experto).\n- No incluir opiniones personales subjetivas fuera del marco del código.\n- La búsqueda de información debe ser actual y verificada.`;

      document.getElementById("formato").value = 
`- Informe técnico estructurado.\n- Sección 1: Referencias Normativas (Artículos citados).\n- Sección 2: Análisis del Conflicto (Ingeniería vs Ética).\n- Sección 3: Veredicto y Recomendaciones.`;
    }

    function insertarEnTextarea(areaId, selectElement) {
      const textarea = document.getElementById(areaId);
      const texto = selectElement.value;
      if (texto && !textarea.value.includes(texto)) {
        if (textarea.value.trim() !== '') {
          textarea.value += '\n';
        }
        textarea.value += `- ${texto}`;
      }
      selectElement.selectedIndex = 0;
    }
  </script>
</body>
</html>